id: rfc5280
rules:
  - id: version-v3
    target: certificate.version
    operator: eq
    operands: [3]
    severity: error

  - id: serial-number-present
    target: certificate.serialNumber
    operator: present
    operands: []
    severity: error

  - id: signature-algorithm-secure
    target: certificate.signatureAlgorithm.algorithm
    operator: in
    operands:
      - SHA256-RSA
      - SHA384-RSA
      - SHA512-RSA
      - ECDSA-SHA256
      - ECDSA-SHA384
      - ECDSA-SHA512
      - Ed25519
    severity: error

  - id: signature-algorithm-not-weak
    target: certificate.signatureAlgorithm.algorithm
    operator: notIn
    operands:
      - MD5-RSA
      - SHA1-RSA
      - DSA-SHA1
      - ECDSA-SHA1
    severity: error

  - id: issuer-present
    target: certificate.issuer
    operator: present
    operands: []
    severity: error

  - id: subject-present
    target: certificate.subject
    operator: present
    operands: []
    severity: warning

  - id: rsa-key-size-minimum
    target: certificate.subjectPublicKeyInfo.publicKey.keySize
    operator: gte
    operands: [2048]
    severity: error

  - id: rsa-exponent-valid
    target: certificate.subjectPublicKeyInfo.publicKey.exponent
    operator: gte
    operands: [65537]
    severity: warning

  - id: authority-key-identifier-present
    target: certificate.authorityKeyIdentifier
    operator: present
    operands: []
    severity: warning

  - id: subject-key-identifier-present
    target: certificate.subjectKeyIdentifier
    operator: present
    operands: []
    severity: warning

  - id: key-usage-present
    target: certificate.keyUsage
    operator: present
    operands: []
    severity: warning

  - id: basic-constraints-present
    target: certificate.basicConstraints
    operator: present
    operands: []
    severity: warning
