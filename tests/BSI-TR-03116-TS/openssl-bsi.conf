# Embedded OpenSSL config for BSI chain (root, intermediate, leaf)

[ ca ]
default_ca = CA_default

[ CA_default ]
dir               = ./demoCA
database          = $dir/index.txt
new_certs_dir     = $dir/newcerts
serial            = $dir/serial
private_key       = ./out/root.key.pem
certificate       = ./out/root.cert.pem
default_md        = sha256
policy            = policy_any
default_days      = 3650

[ policy_any ]
countryName             = optional
stateOrProvinceName     = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = supplied
emailAddress            = optional

[ req ]
default_bits        = 2048
default_md          = sha256
prompt              = no
distinguished_name  = dn_default

[ dn_default ]
C = DE
ST = Berlin
L = Berlin
O = ExampleOrg
OU = ExampleUnit
CN = example.root.test

################################################################################
# Extension sections mapped from your policies (fixed AIA syntax)
################################################################################

# Root CA extensions (Root Policy)
[ v3_root_ca ]
basicConstraints = critical,CA:TRUE,pathlen:2
keyUsage = critical, keyCertSign, cRLSign
subjectKeyIdentifier = hash
crlDistributionPoints = @crl_info
authorityInfoAccess = OCSP;URI:http://ocsp.example.test, CA Issuers;URI:http://crt.example.test/issuer.crt

# Intermediate CA extensions (Intermediate Policy)
[ v3_intermediate_ca ]
basicConstraints = critical,CA:TRUE,pathlen:1
keyUsage = critical, keyCertSign, cRLSign
subjectKeyIdentifier = hash
authorityKeyIdentifier = keyid:always,issuer
crlDistributionPoints = @crl_info
authorityInfoAccess = OCSP;URI:http://ocsp.example.test, CA Issuers;URI:http://crt.example.test/issuer.crt

# Leaf / End entity extensions (Leaf Policy)
[ v3_leaf ]
basicConstraints = CA:FALSE
keyUsage = critical, digitalSignature, keyEncipherment
extendedKeyUsage = serverAuth
subjectAltName = @alt_names
authorityKeyIdentifier = keyid,issuer
crlDistributionPoints = @crl_info
authorityInfoAccess = OCSP;URI:http://ocsp.example.test, CA Issuers;URI:http://crt.example.test/issuer.crt

# CRL Distribution Points placeholder
[ crl_info ]
URI.1 = http://crl.example.test/bsi.crl

[ alt_names ]
DNS.1 = leaf.example.test